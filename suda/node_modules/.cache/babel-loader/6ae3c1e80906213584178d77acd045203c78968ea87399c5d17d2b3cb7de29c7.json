{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport TopBar from \"@/components/TopBar.vue\";\nimport MovieSwiper from \"@/components/MovieSwiper.vue\";\nexport default {\n  name: \"planDetail\",\n  components: {\n    TopBar,\n    MovieSwiper\n  },\n  data() {\n    return {\n      hallId: \"\",\n      //影院Id\n      movieId: \"\",\n      //电影Id\n      planId: \"\",\n      //排片Id\n      planData: \"\",\n      //电影排片数据\n      showingMovieList: [],\n      //热映的电影列表\n      active: 0,\n      //tab栏默认获取索引值\n      currentActive: 0,\n      //当前轮播图活动索引\n      tabTitle: [] // tab栏的标题\n    };\n  },\n\n  methods: {\n    // 顶部返回按钮点击触发\n    backIconClick() {\n      this.$router.back();\n    },\n    // 根据影院Id查询影院\n    async getPlanDetail() {\n      const {\n        data: {\n          planData\n        }\n      } = await this.$http.get(`/movie/${this.movieId}`);\n      // ------数据处理------\n      // 获取该影院信息\n      this.planData = planData.plans;\n      // console.log(\"影院信息\", this.cinemaData);\n      this.showingMovieList = planData.movieId;\n      // console.log(\"正在热映电影列表\", this.showingMovieList);\n      // 如果movieId存在，证明是从电影详情页点进来的，跳往指定电影\n      // 默认显示本页面id对应的电影数据,先跳往对应轮播图\n      // 获取该电影的索引值，然后跳往\n      // if (this.movieId) {\n      //   const index = this.showingMovieList.findIndex((item) => {\n      //     return item._id == this.movieId;\n      //   });\n      //   this.$nextTick(() => {\n      //     this.$refs.movieSwiper.slideTo(1);\n      //   });\n      // }\n    },\n\n    // 轮播图改变时触发函数\n    swiperChange(index) {\n      this.currentActive = index;\n      this.active = 0;\n    },\n    // 点击购票触发\n    async payClick(moviePlan) {\n      // 先判断是否登录\n      if (await this.isLogin()) {\n        // console.log(moviePlan);\n        this.$router.push({\n          path: \"/seatSelect\",\n          query: {\n            planId: moviePlan._id\n          }\n        });\n      }\n    }\n  },\n  created() {\n    // this.planId = this.$route.query.planId;\n    this.movieId = this.$route.query.movieId;\n    const today = this.$options.filters.date(new Date(), \"YYYY-MM-DD\");\n    const todayTime = new Date(today).getTime();\n    const tomorrowTime = todayTime + 1 * 24 * 60 * 60 * 1000;\n    const afterTomorrowTime = todayTime + 2 * 24 * 60 * 60 * 1000;\n    const tomorrowMM = this.$options.filters.date(new Date(tomorrowTime), \"MM\");\n    const tomorrowDD = this.$options.filters.date(new Date(tomorrowTime), \"DD\");\n    const afterTomorrowMM = this.$options.filters.date(new Date(afterTomorrowTime), \"MM\");\n    const afterTomorrowDD = this.$options.filters.date(new Date(afterTomorrowTime), \"DD\");\n    this.tabTitle.push(`明天${tomorrowMM}月${tomorrowDD}日`);\n    this.tabTitle.push(`后天${afterTomorrowMM}月${afterTomorrowDD}日`);\n  },\n  mounted() {\n    this.getPlanDetail();\n  }\n};","map":{"version":3,"mappings":";AAsGA;AACA;AACA;EACAA;EACAC;IACAC;IACAC;EACA;EACAC;IACA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;IACA;EACA;;EACAC;IACA;IACAC;MACA;IACA;IACA;IACA;MACA;QACAV;UAAAI;QAAA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;;IACA;IACAO;MACA;MACA;IACA;IACA;IACA;MACA;MACA;QACA;QACA;UACAC;UACAC;YACAV;UACA;QACA;MACA;IACA;EACA;EACAW;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA,mDACA,6BACA,KACA;IACA,mDACA,6BACA,KACA;IACA;IACA;EACA;EACAC;IACA;EACA;AACA","names":["name","components","TopBar","MovieSwiper","data","hallId","movieId","planId","planData","showingMovieList","active","currentActive","tabTitle","methods","backIconClick","swiperChange","path","query","created","mounted"],"sourceRoot":"src/views","sources":["PlanDetail.vue"],"sourcesContent":["<template>\n  <div class=\"cinema-detail\">\n    <!-- 顶部topBar部分 -->\n    <TopBar\n      bgc=\"#fff\"\n      :centerContent=\"cinemaData.name ? cinemaData.name : '影院'\"\n      @backIconClick=\"backIconClick\"\n    >\n    </TopBar>\n    <!-- 影院信息部分 -->\n<!--    <div class=\"cinemaDetail\" v-if=\"cinemaData\">-->\n<!--      <div class=\"title\">-->\n<!--        <h2>{{ cinemaData.name }}</h2>-->\n<!--      </div>-->\n<!--      <div class=\"address\">-->\n<!--        <span class=\"ellipsis-two\"-->\n<!--          ><van-icon name=\"location-o\" />{{ cinemaData.address }}</span-->\n<!--        >-->\n<!--      </div>-->\n<!--      <div class=\"phone\">-->\n<!--        <span><van-icon name=\"phone-o\" />{{ cinemaData.phone }}</span>-->\n<!--      </div>-->\n<!--    </div>-->\n    <!-- 轮播图部分 -->\n    <div class=\"swiper-bgc\" v-if=\"showingMovieList.length\">\n      <MovieSwiper ref=\"movieSwiper\" @swiperChange=\"swiperChange\">\n        <swiper-slide v-for=\"item in showingMovieList\" :key=\"item._id\">\n          <img :src=\"item.icon\" />\n        </swiper-slide>\n      </MovieSwiper>\n      <div class=\"triangle\"></div>\n    </div>\n    <!-- 电影详情部分 -->\n    <div class=\"movieDetail\" v-if=\"planData\">\n      <div class=\"movieDetail-title\">\n        <div class=\"movie-name\">{{ planData.name }}</div>\n      </div>\n      <div class=\"movieDetail-content\">\n        <div class=\"movieDetail-content-center\">\n          <span>{{ showingMovieList[currentActive].duration }}</span>\n          <span class=\"sign\">|</span>\n          <span>{{\n            showingMovieList[currentActive].type[0].split(\"、\")[0]\n          }}</span>\n          <span class=\"sign\">|</span>\n          <span>{{\n            showingMovieList[currentActive].performer.split(\"、\")[0]\n          }}</span>\n        </div>\n      </div>\n    </div>\n    <!-- Tab标签页 -->\n    <div class=\"tab\" v-if=\"showingMovieList.length\">\n      <van-tabs\n        v-model=\"active\"\n        title-active-color=\"#ee0a24\"\n        line-width=\"30vw\"\n        line-height=\"0.2308rem\"\n      >\n        <van-tab\n          :title=\"tabTitle[index]\"\n          v-for=\"(item, index) in planData.plans\"\n          :key=\"index\"\n        >\n          <div class=\"movie-plan\" v-for=\"(item1, index1) in item\" :key=\"index1\">\n            <div class=\"movie-plan-left\">\n              <div class=\"inTime\">{{ item1.inTime }}</div>\n              <div class=\"outTime\">{{ item1.leaveTime }}散场</div>\n            </div>\n            <div class=\"movie-plan-center\">\n              <div class=\"type\">\n                <div class=\"language\">\n                  {{ item1.movieId.language + item1.movieId.category }}\n                </div>\n                <div class=\"position ellipsis\">{{ item1.hall }}</div>\n              </div>\n              <div class=\"money\">{{ item1.price }}元</div>\n            </div>\n            <div class=\"movie-plan-right\" @click.stop=\"payClick(item1)\">\n              <div class=\"pay\">购票</div>\n            </div>\n          </div>\n          <div v-if=\"!item.length\" class=\"bgc-show1\">\n            <div class=\"bgc-show-center\">\n              <div class=\"logo\"><i class=\"iconfont icon-nothing\"></i></div>\n              <div class=\"content\"><span>暂无上映场次</span></div>\n            </div>\n          </div>\n        </van-tab>\n      </van-tabs>\n    </div>\n    <!-- 在无上映电影时的占位背景 -->\n    <div v-if=\"!showingMovieList.length\" class=\"bgc-show\">\n      <div class=\"bgc-show-center\">\n        <div class=\"logo\"><i class=\"iconfont icon-nothing\"></i></div>\n        <div class=\"content\"><span>该影院暂无上映电影</span></div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport TopBar from \"@/components/TopBar.vue\";\nimport MovieSwiper from \"@/components/MovieSwiper.vue\";\nexport default {\n  name: \"planDetail\",\n  components: {\n    TopBar,\n    MovieSwiper,\n  },\n  data() {\n    return {\n      hallId: \"\", //影院Id\n      movieId: \"\", //电影Id\n      planId:\"\",  //排片Id\n      planData: \"\", //电影排片数据\n      showingMovieList: [], //热映的电影列表\n      active: 0, //tab栏默认获取索引值\n      currentActive: 0, //当前轮播图活动索引\n      tabTitle: [], // tab栏的标题\n    };\n  },\n  methods: {\n    // 顶部返回按钮点击触发\n    backIconClick() {\n      this.$router.back();\n    },\n    // 根据影院Id查询影院\n    async getPlanDetail() {\n      const {\n        data: { planData },\n      } = await this.$http.get(`/movie/${this.movieId}`);\n      // ------数据处理------\n      // 获取该影院信息\n      this.planData =planData.plans;\n      // console.log(\"影院信息\", this.cinemaData);\n      this.showingMovieList = planData.movieId;\n      // console.log(\"正在热映电影列表\", this.showingMovieList);\n      // 如果movieId存在，证明是从电影详情页点进来的，跳往指定电影\n      // 默认显示本页面id对应的电影数据,先跳往对应轮播图\n      // 获取该电影的索引值，然后跳往\n      // if (this.movieId) {\n      //   const index = this.showingMovieList.findIndex((item) => {\n      //     return item._id == this.movieId;\n      //   });\n      //   this.$nextTick(() => {\n      //     this.$refs.movieSwiper.slideTo(1);\n      //   });\n      // }\n    },\n    // 轮播图改变时触发函数\n    swiperChange(index) {\n      this.currentActive = index;\n      this.active = 0;\n    },\n    // 点击购票触发\n    async payClick(moviePlan) {\n      // 先判断是否登录\n      if (await this.isLogin()) {\n        // console.log(moviePlan);\n        this.$router.push({\n          path: \"/seatSelect\",\n          query: {\n            planId: moviePlan._id,\n          },\n        });\n      }\n    },\n  },\n  created() {\n    // this.planId = this.$route.query.planId;\n    this.movieId = this.$route.query.movieId;\n    const today = this.$options.filters.date(new Date(), \"YYYY-MM-DD\");\n    const todayTime = new Date(today).getTime();\n    const tomorrowTime = todayTime + 1 * 24 * 60 * 60 * 1000;\n    const afterTomorrowTime = todayTime + 2 * 24 * 60 * 60 * 1000;\n    const tomorrowMM = this.$options.filters.date(new Date(tomorrowTime), \"MM\");\n    const tomorrowDD = this.$options.filters.date(new Date(tomorrowTime), \"DD\");\n    const afterTomorrowMM = this.$options.filters.date(\n      new Date(afterTomorrowTime),\n      \"MM\"\n    );\n    const afterTomorrowDD = this.$options.filters.date(\n      new Date(afterTomorrowTime),\n      \"DD\"\n    );\n    this.tabTitle.push(`明天${tomorrowMM}月${tomorrowDD}日`);\n    this.tabTitle.push(`后天${afterTomorrowMM}月${afterTomorrowDD}日`);\n  },\n  mounted() {\n    this.getPlanDetail();\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n// 最外层容器\n.cinema-detail {\n  background-color: #fff;\n  height: 100vh;\n  width: 100vw;\n}\n// 影院信息部分\n.cinemaDetail {\n  width: 100vw;\n  height: 7.6923rem;\n  padding: 0.7692rem;\n  text-align: justify;\n  font-size: 1.0769rem;\n  color: rgb(137, 137, 137);\n  .title {\n    color: #000;\n    // height: 30%;\n  }\n  .address {\n    height: 50%;\n    width: 100%;\n    display: flex;\n    align-items: center;\n  }\n  .phone {\n    height: 20%;\n  }\n}\n// 轮播图部分\n.swiper-bgc {\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 15.3846rem;\n  width: 100vw;\n  background-color: #1b1d37;\n  img {\n    width: 9.2308rem;\n    height: 12.9231rem;\n  }\n  // 轮播图部分里面的小三角\n  .triangle {\n    z-index: 10;\n    bottom: -0.0769rem;\n    left: 50%;\n    transform: translateX(-50%);\n    position: absolute;\n    width: 0rem;\n    height: 0rem;\n    border-bottom: 0.7692rem solid #fff;\n    border-left: 0.7692rem solid transparent;\n    border-right: 0.7692rem solid transparent;\n  }\n}\n\n// 电影描述部分\n.movieDetail {\n  margin: 0.3846rem 0;\n  height: 4.2308rem;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-around;\n  align-items: center;\n  .movieDetail-title {\n    display: flex;\n    div {\n      font-size: 1.2308rem;\n      margin: 0 0.7692rem;\n    }\n    .movie-score {\n      color: #ffb400;\n    }\n  }\n  .movieDetail-content {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    align-items: center;\n    font-size: 1.0769rem;\n    color: rgb(145, 145, 145);\n    .movieDetail-content-center {\n      .sign {\n        margin: 0 0.3846rem;\n      }\n    }\n  }\n}\n\n// Tab标签页\n.tab {\n  .movie-plan {\n    padding: 1.1538rem 0.7692rem;\n    display: flex;\n    border-bottom: 1px solid #ccc;\n    height: 5.7692rem;\n    .movie-plan-left {\n      height: 100%;\n      width: 25%;\n      display: flex;\n      flex-direction: column;\n      justify-content: space-around;\n      align-items: flex-start;\n      .inTime {\n        font-size: 1.2308rem;\n        font-weight: 700;\n      }\n      .outTime {\n        color: rgb(171, 171, 171);\n      }\n    }\n    .movie-plan-center {\n      height: 100%;\n      width: 60%;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      text-align: left;\n      .type {\n        width: 60%;\n        height: 100%;\n        display: flex;\n        flex-direction: column;\n        justify-content: space-around;\n        align-items: flex-start;\n        .position {\n          width: 100%;\n          color: rgb(171, 171, 171);\n        }\n      }\n      .money {\n        width: 30%;\n        color: #ee0a24;\n        font-size: 1.1538rem;\n      }\n    }\n    .movie-plan-right {\n      width: 15%;\n      display: flex;\n      justify-content: flex-end;\n      align-items: center;\n      .pay {\n        border: 0.0769rem solid #ee0a24;\n        padding: 0.2308rem 0.7692rem;\n        border-radius: 1.5385rem;\n        color: #ee0a24;\n      }\n    }\n  }\n}\n// 在明天或后天栏目里面没有排电影时显示的背景\n.bgc-show1 {\n  .bgc-show-center {\n    margin-top: 1.9231rem;\n    font-size: 1.3846rem;\n    i {\n      font-size: 6.1538rem;\n    }\n    .content {\n      margin-top: 1.9231rem;\n    }\n  }\n}\n\n// 占位背景\n.bgc-show {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: fixed;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  background-color: rgb(240, 239, 239);\n  .bgc-show-center {\n    color: rgb(159, 159, 159);\n    .logo {\n      i {\n        font-size: 11.5385rem;\n      }\n    }\n    .content {\n      margin-top: 2.3077rem;\n      font-size: 1.5385rem;\n    }\n  }\n}\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}